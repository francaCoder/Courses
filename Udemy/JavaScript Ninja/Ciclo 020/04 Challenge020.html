<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Challenge020</title>
    <style>
        body { font-family: sans-serif }
        label { display: block }
        input { margin-bottom: 10px }
    </style>
</head>
<body>
    <form action="." method="get">
        <div>
            <label>Name:</label>
            <input type="text">
        </div>

        <div>
            <label>E-mail:</label>
            <input type="email">
        </div>

        <div>
            <label>Message:</label>
            <textarea cols="30" rows="10"></textarea>
        </div>

        <div>
            <button type="submit">Submit</button>
        </div>
    </form>

    <script>

        (function(window, document){
            'use strict'

            /* 
            When creating the page, ask to the user "What's your name?". Assign the result to the variable called 'username'. If the user don't put nothing inside button, 'username' must receive 'unknown'
            */

            let username = prompt("What's your name?") || "[Unknown] Put your name"
            alert(`Welcome ${username}`)

            /* 
            Now ask to the usar "What's you E-mail ?" assigning the result to the variable called 'email'
            */

            let email = prompt("What's your E-mail ?")

            /* 
            Select the input of 'name', assigning to the variable called '$inputUsername'
            */

            let $inputUsername = document.querySelector("input[type='text']")

            /* 
            Select the input of 'Email', assigning to the variable called '$inputEmail'
            */

            let $inputEmail = document.querySelector("input[type='email']")

            /* 
            Select the field of  'Message', assigning to the variable called '$message'
            */

            let $message = document.querySelector("textarea")

            /* 
            Select the button of 'submit' of form, assigning to the variable called '$button'
            */

            let $button = document.querySelector("button")

            /* 
            Fill in the fields of 'name' and 'E-mail' that be in document with the entered values by user
            */

            $inputUsername.value = username
            $inputEmail.value = email

            /* 
            Add an event listiner of 'click' to button that do the following:
            1. Check if all fields are filled
            - Show an alert for each field aren't fill in
            - For each field aren't fill in, show a new alert speaking for fill in this field
            - Check if the field of 'E-mail' is valid, else be, show an alert

            2. For verify if the E-mail is valid, use the function 'isValidEmail', passing the e-mail that was entered in field of 'E-mail' per parameter. The function 'isValidEmail' will be created below

            3. If all be ok, ask to user:
            - "Are you sure that you want send this form?"
            If yes show an alert with 'Form sent' , else show 'Form not sent'
            */

            $button.addEventListener('click', function(event) {
                event.preventDefault()
                if (!$inputUsername.value) {
                    return alert("Fill in with the name of user")
                }
                if (!$inputEmail.value) {
                    return alert("Fill in with the E-mail of user")
                }
                if (!$message.value) {
                    return alert("Fill in the message")
                }
                if (!isValidEmail($inputEmail.value)) {
                    return alert("Fill in with a valid E-mail")
                }
                if(!confirm("You have sure that you want submit this form?")) {
                    return alert("Error sending")
                }
                return alert("Successfully sended!")
            }, false)

            /* 
            create a function called 'isValidEmail' that will be used in the form submission validation
            This function must receive the e-mail per parameter and verify if is a valid e-mail.
            The rules for validation are:
            - The name of user (before @), can be any character
            - Afetr @, the domain can have only alphanumeric characters  and underscore
            - For the extension, the domain must be followed by a full stop and at least 2 alphanumerics characters
            - The end of domain is optional, but if exist, must begin with a full stop, followed by maximum 2 alphanumerics characters

            some e-mails that can be used for check if is valid
            my.email+category@gmail.com
            juca_malandro@bol.com.br
            pedrobala@hotmail.com.uy
            sandro@cooking.dahora

            some invalid E-mails 
            walter-da-silva@maraca.br
            rita-marica@titica.a.b
            agua_@evida.br.com
            */

            function isValidEmail(email) {
                return /^[\w+.]+@\w+\.\w{2,}(?:\.\w{2})?$/.test(email)
            }



        })(window, document)

    </script>
    
</body>
</html>